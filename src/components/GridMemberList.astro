---
// © Vlad-Stefan Harbuz <vlad@vlad.website>
// SPDX-License-Identifier: Apache-2.0

import { sortMembersByDevs, fmtCurrency, fmtDevs, getDollarsPerDev } from '../members/common.ts';
import type { Member } from '../members/common.ts';

interface Props {
  members: Member[];
}

const { members } = Astro.props;
---

<div class="grid-member-list">
  <div class="members">
    {sortMembersByDevs(members).map((member) =>
      <a
        class="member sneaky"
        href={`/members/${member.id}`}
        data-ndevs={member.annualReports[0].averageNumberOfDevs}
        data-join-date={member.joinDate}
        data-name={member.name}
      >
        <div class="main">
          <img src=`/images/members/${member.id}/logo.webp` alt=`The ${member.name} logo`>
          <h2>
            <div>{member.name}</div>
            {member.role != "Member" &&
              <div class="label">{member.role}</div>
            }
          </h2>
        </div>
        <em>“{member.shortDescription}”</em>
        <div class="numbers">
          <span>{fmtDevs(member.annualReports[0].averageNumberOfDevs)}</span>
          <span>{fmtCurrency(getDollarsPerDev(member.annualReports[0]))} / dev</span>
        </div>
      </a>
    )}
  </div>
  <small>
    “Devs”: Average number of employed full-time equivalent developers (in latest report).<br>
    “$ / dev”: USD paid / average number of employed full-time equivalent developers (in latest report).
  </small>
</div>

<style>
  .members {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(17rem, 1fr));
    gap: 1rem;
    @media (max-width: 860px) {
      grid-template-columns: 1fr;
    }
  }
  small {
    display: block;
    margin-top: 1rem;
  }
  a.member {
    display: flex;
    flex-direction: column;
    gap: 1rem;
    margin: 0;
    padding: 1rem;
    background-color: var(--color-light-bg);
    border: 3px solid transparent;
    border-radius: 0.5rem;
    font-size: smaller;
    cursor: pointer;
    @media (max-width: 450px) {
      padding: 0.5rem;
    }
    &:hover {
      border: 3px solid var(--color-secondary);
      text-decoration: none;
      color: white;
    }
    .main {
      display: flex;
      gap: 1rem;
      align-items: center;
      img {
        align-self: center;
        max-width: 4.5rem;
        border-radius: 0.5rem;
        @media (max-width: 450px) {
          max-width: 3.0rem;
        }
      }
      h2 {
        margin: 0;
        font-size: 1.2rem;
        line-height: 1.3;
        .label {
          margin-top: 0.5rem;
          font-size: 0.8rem;
        }
      }
    }
    em {
      flex: 1 0;
    }
    .numbers {
      flex: 0 1;
      display: flex;
      justify-content: space-between;
    }
  }
</style>
